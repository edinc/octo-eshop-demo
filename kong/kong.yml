_format_version: '3.0'
_transform: true

services:
  - name: user-service
    url: http://user-service:3000
    routes:
      - name: user-routes
        paths:
          - /api/users
        strip_path: false

  - name: product-service
    url: http://product-service:3000
    routes:
      - name: product-routes
        paths:
          - /api/products
        strip_path: false

  - name: cart-service
    url: http://cart-service:3000
    routes:
      - name: cart-routes
        paths:
          - /api/cart
        strip_path: false

  - name: order-service
    url: http://order-service:3000
    routes:
      - name: order-routes
        paths:
          - /api/orders
        strip_path: false

  - name: payment-service
    url: http://payment-service:3000
    routes:
      - name: payment-routes
        paths:
          - /api/payments
        strip_path: false

plugins:
  - name: cors
    config:
      origins:
        - http://localhost:3000
      methods:
        - GET
        - POST
        - PUT
        - DELETE
        - OPTIONS
      headers:
        - Accept
        - Authorization
        - Content-Type
      exposed_headers:
        - X-Auth-Token
      credentials: true
      max_age: 3600

  - name: rate-limiting
    config:
      minute: 100
      policy: local

  - name: request-size-limiting
    config:
      allowed_payload_size: 10
